<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="Glacial - Accueil">
    <meta name="author" content="Tommy Savaria">

    <title>Glacial</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/starter-template.css" rel="stylesheet">

	<style type="text/css">
		#releasetable
		{
			border-spacing: 0% 2%;
			border-collapse: separate;
			width: 100%;
		}
		
		#releasetable td
		{
			padding-top: 1%;
			padding-bottom: 1%;
			border-bottom: 1px solid gray;
		}
		
		.cellcenter
		{
			text-align: center;
		}
	</style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
          </button>
          <a class="navbar-brand" href="index.html">Glacial</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a href="index.html">Accueil</a></li>
			<li class="active"><a>Télécharger</a></li>
			<li><a href="licence.html">Licence</a></li>
			<li><a href="contributeurs.html">Contributeurs</a></li>
			<li><a href="https://github.com/antoineMoPa/glacial">GitHub</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

	<div class="jumbotron">
		<div class="container">
			<h1>Téléchargements</h1>
			<p>Vous avez ici tous les liens de téléchargements pour toutes les versions de Glacial. Nous vous suggérons la suivante, mais vous pouvez aller en chercher une plus vieille si vous les désirez.</p>
			<p id="glacialbouton"></p>
		</div>
	</div>
	
    <div class="container">
		
		<h2>Releases</h2>
		
		<table id="releasetable"></table>
		
		<hr></hr>
		
		<footer>
			<p>Site web développé par Tommy Savaria</p>
			<p>Contactez-moi à: <a href="mailto:tommy.savaria@protonmail.ch"><i>tommy.savaria@protonmail.ch</i></a></p>
		</footer>

    </div><!-- /.container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js"></script>
	<script src="js/detect_browser.js"></script>
	<script>
		var releases = [];
		
		//Create a new Releasem object
		function Release(rel)
		{
			this.name = rel.name;
			this.zip = rel.tarball_url;
			this.tarball = rel.zipball_url;
			
			var ff = undefined;
			var cr = undefined;
			
			rel.assets.forEach( function(element, array, index) {
					var temp = element.browser_download_url.split(".");
					if(temp[temp.length - 1] == "xpi")
					{
						//Firefox XPI
						ff = element.browser_download_url;
					}
					else if(temp[temp.length - 1] == "crx")
					{
						//Chrome CRX
						cr = element.browser_download_url;
					}
				}			
			);
			
			this.firefox = ff;
			this.chrome = cr;
		}
		
		function addRelease(rel)
		{
			var htmlString = "<tr>";
			htmlString += "<td class=\"col-md-4\">";
			htmlString += rel.name;
			htmlString += "</td>";
			htmlString += "<td class=\"col-md-2 cellcenter\">"
			
			//If there is an xpi for FireFox
			if(rel.firefox !== undefined)
				htmlString += "<a href=\"" + rel.firefox + "\" class=\"btn btn-default btn-warning\">Firefox</a>";
			
			htmlString += "</td>";
			htmlString += "<td class=\"col-md-2 cellcenter\">"
			
			//If there is a crx for Chrome
			if(rel.chrome !== undefined)
				htmlString += "<a href=\"" + rel.chrome + "\" class=\"btn btn-default btn-primary\">Chrome</a>";
			
			htmlString += "</td>";
			htmlString += "<td class=\"col-md-2 cellcenter\">"
			
			//Zipball
			htmlString += "<a href=\"" + rel.zip + "\" class=\"btn btn-default\">Source (zip)</a>";
			
			htmlString += "</td>";
			htmlString += "<td class=\"col-md-2 cellcenter\">"
			
			//Tarball
			htmlString += "<a href=\"" + rel.tarball + "\" class=\"btn btn-default\">Source (tar.gz)</a>";
			
			htmlString += "</td>";
			htmlString += "</tr>"
			
			$("#releasetable").append(htmlString);
		}
		
		function addPreferredLink(array)
		{
		}
		
		$.getJSON("https://api.github.com/repos/antoineMoPa/glacial/releases", "",
			function(data, textStatus, jqXHR) {
				for(var i = 0; i < data.length; i++)
				{
					releases.push(new Release(data[i]));
					addRelease(releases[i])
				}
			
				var latestRelease = data[data.length - 1];
				//$("#glacialversion").html(latestRelease.name);
				//$("#glaciallien").attr("href", latestRelease.html_url);
				
				if((!isMobile.any()) && (BrowserDetect.browser == "Firefox"))
				{
					$("#glacialbouton").prepend("<a href=\"" + latestRelease.assets[0].browser_download_url + "\" class=\"btn btn-lg btn-warning\">" + latestRelease.name + " pour Firefox</a>");
				}
			}
		);
	</script>
  </body>
</html>
